t = [0 1 2 3 4 5 6 7 8 9];

u = [366 381 376 400 410 402 430 447 440 497];
v = [474 446 408 417 331 365 371 371 420 450];
w = [440 424 440 448 423 381 386 407 418 420];
z = [427 447 415 426 413 426 425 433 442 445];

b1 = u;

c = (v*b1') / (b1*b1');
b2 = v - c*b1;

c1 = (w*b1') / (b1*b1');
c2 = (w*b2') / (b2*b2');
b3 = w - (c1*b1 + c2*b2);

cc1 = (z*b1') / (b1*b1');
cc2 = (z*b2') / (b2*b2');
cc3 = (z*b3') / (b3*b3');
b4 = z - (cc1*b1 + cc2*b2 + cc3*b3);

figure(1)
plot (t, u, '*-', t, v, '*-', t, w, '*-', t, z, '*-', 0, 300, 9, 530);
figure(2)
plot (t, b1, 'o-', t, b2, 'o-', t, b3, 'o-', t, b4, 'o-', 0, -100, 9, 500);
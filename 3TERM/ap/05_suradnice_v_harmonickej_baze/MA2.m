clear

t = linspace(0,20,21);

f = [1 1 2 3 5 40 3 4 5 6 6 5 3 2 2 80 4 5 3 4 5];

% --------------------------MA(2)----------------------------

fz = f(2:20);

tz = t(2:20);

b1 = f(1:19);
b2 = f(3:21);

B = [b1;b2];

c = (fz*B')*(B*B')^(-1);

fp = c*B;


% --------------------------MA(4)----------------------------

fz4 = f(3:19);

tz4 = t(3:19);

b1 = f(2:18);
b2 = f(1:17);
b3 = f(4:20);
b4 = f(5:21);


B4 = [b1;b2;b3;b4];

c4 = (fz4*B4')*(B4*B4')^(-1);

fp4 = c4*B4;

plot(t,f,'*-',tz,fp,'o-',tz4,fp4,'o-k');